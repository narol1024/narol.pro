<% if (theme.intensedebate.enable && theme.intensedebate.acct){ %>
  <%- css('css/comments') %>
<% } %>

<% if (is_archive() || is_category() || is_tag()){ %>
<script type="text/javascript">
let tgl=(s)=>{x=document.getElementsByName("expand");for(let i=0;i<x.length;i++)x[i].checked=s.checked;}
</script>
<% } %>
<% if (theme.settings){ %>
<div id="settings-container">
  <i id="dark-mode" class="icss icss-moon"></i>
  <div id="sans-font" style="display: none;">sans</div>
</div>
<script>
  // Wait for the DOM to be loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Create alt text labels for all images
    var images = document.getElementsByTagName('img');
    for(var i = 0; i < images.length; i++) {
      var text = `图${i + 1}`;
      var label = document.createElement('div');
      label.textContent = text;
      label.className = 'img-title';
      images[i].insertAdjacentElement('afterend', label);
    }
  });
  </script>
<script type="text/javascript">
  let d = document,
    r = d.documentElement.style,
    f = r.setProperty.bind(r),
    l = localStorage,
    s =
      l.getItem('s') ||
      (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
  let 
    n = l.getItem('n'),
    m = d.getElementById('dark-mode'),
    b = () => {
      // light
      f('--bg-color', 'linear-gradient(to right, rgba(0, 0, 0, 0.04) 1px, transparent 1px), linear-gradient(to bottom, rgba(0, 0, 0, 0.04) 1px, transparent 1px)');
      f('--code-bg-color', '#f4f4f4');
      f('--text-color', '#212121');
      f('--secondary-color', '#808080');
      f('--tertiary-color', '#b0b0b0');
      f('--link-color', '#b5c8cf');
      f('--link-hover-color', '#618794');
      f('--link-bg-color', '#dae4e7');
      f('--selection-color', '#dae4e7');
      m.classList.remove('icss-sun');
      m.classList.add('icss-moon');

      const metaList = document.getElementsByTagName("meta");
      for (let i = 0; i < metaList.length; i++) {
        if (metaList[i].getAttribute("name") == "theme-color") {
          metaList[i].content = '#ffffff';
        }
      }
    },
    c = () => {
      // dark
      f('--bg-color', 'linear-gradient(to bottom, rgba(0, 0, 0, 0.04) 1px, #212121 1px), linear-gradient(to right, rgba(0, 0, 0, 0.96) 1px, #212121 1px)');
      f('--code-bg-color', '#292929');
      f('--text-color', '#fff');
      f('--secondary-color', '#c0c0c0');
      f('--tertiary-color', '#6e6e6e');
      f('--link-color', '#4d6b75');
      f('--link-hover-color', '#96b1bb');
      f('--link-bg-color', '#5d828e');
      f('--selection-color', '#acc1c9');
      m.classList.remove('icss-moon');
      m.classList.add('icss-sun');

      const metaList = document.getElementsByTagName("meta");
      for (let i = 0; i < metaList.length; i++) {
        if (metaList[i].getAttribute("name") == "theme-color") {
          metaList[i].content = '#212121';
        }
      }
    },
    o = d.getElementById('sans-font'),
    e = () => {
      f('--body-stack', '"Lora", "Georgia", "Times New Roman", serif');
      o.innerHTML = 'sans';
    },
    g = () => {
      f(
        '--body-stack',
        '"Lato", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "Verdana", sans-serif',
      );
      o.innerHTML = 'serif';
    };
  m.onclick = () => {
    if (s == 2) {
      s = 1;
      l.setItem('s', s);
      c();
    } else {
      s = 2;
      l.setItem('s', s);
      b();
    }
  };
  o.onclick = () => {
    if (n == 2) {
      n = 1;
      l.setItem('n', n);
      g();
    } else {
      n = 2;
      l.setItem('n', n);
      e();
    }
  };
  if (!s) {
    s = 2;
    l.setItem('s', 2);
  }
  if (s == 1) {
    c();
  }
  if (!n) {
    n = 2;
    l.setItem('n', 2);
  }
  if (n == 1) {
    g();
  }
</script>
<% } %> <% if (theme.google_analytics.enable && theme.google_analytics.acct){ %>
<script type="text/javascript">
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    (i[r] =
      i[r] ||
      function () {
        (i[r].q = i[r].q || []).push(arguments);
      }),
      (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

  ga('create', '<%= theme.google_analytics.acct %>', 'auto');
  ga('send', 'pageview');
</script>
<% } %>
<div class="icp">
  <a href="https://beian.miit.gov.cn/" target="_blank">
    粤ICP备2022084378号
  </a>
</div>
